# 更新日志

## v1.2.0 - URL路径用户标识系统

### 🚀 重大变更

- **URL路径识别**：用户标识现在通过URL路径获取 `http://localhost:3000/{userid}`
- **固定用户标识**：不再支持随机生成或手动更改，用户标识由URL路径决定
- **路由结构优化**：所有页面都需要在URL中包含4字符用户标识

### 📐 新的URL结构

```
访问格式：
http://localhost:3000/           - 引导页面（提示输入用户标识）
http://localhost:3000/A1B2       - 用户A1B2的主页
http://localhost:3000/A1B2/audio-library  - 用户A1B2的音频库
http://localhost:3000/A1B2/abc123         - 用户A1B2的录音会话abc123
http://localhost:3000/A1B2/abc123/play/123 - 播放录音
```

### ✨ 新增功能

- **引导页面**：当访问根路径时，显示漂亮的引导界面指导用户输入标识
- **URL验证**：自动验证用户标识格式（4个大写字母或数字）
- **智能跳转**：当用户标识无效时自动跳转到引导页面

### 🔧 技术改进

- **路由参数化**：所有路由都支持用户标识参数
- **工具函数优化**：优先从URL获取用户标识，localStorage作为备份
- **错误处理增强**：用户标识验证失败时的友好提示

### 🎨 界面更新

- **引导页面**：美观的渐变背景，清晰的使用说明
- **用户区域**：显示"已激活"状态，移除重新生成功能
- **导航优化**：所有返回按钮都正确包含用户标识

### ⚠️ 重要说明

- **访问方式变更**：必须通过 `/{userid}` 格式的URL访问应用
- **数据隔离保持**：不同用户的数据依然完全隔离
- **向后兼容**：现有云端数据不受影响

### 📱 使用说明

1. **首次访问**：访问 `http://localhost:3000/` 查看使用说明
2. **用户标识**：选择4个字符的用户标识（如：A1B2、C3D4等）
3. **访问应用**：通过 `http://localhost:3000/{你的标识}` 访问
4. **数据访问**：只能访问该标识下的录音数据

### 🔒 安全特性

- **URL验证**：自动验证用户标识格式和有效性
- **访问控制**：无效标识自动重定向到引导页面
- **数据隔离**：基于URL的用户数据完全隔离

---

## v1.1.0 - 添加4字符用户标识功能

### ✨ 新增功能

- **4字符用户标识系统**：每个用户现在都有一个唯一的4字符标识（如：`A1B2`）
- **用户数据隔离**：不同用户的录音文件完全隔离，存储在各自的云端目录下
- **智能标识管理**：自动生成用户标识，支持手动重新生成

### 🔧 技术改进

- **API路径优化**：所有API调用现在使用 `recordings/{userCode}/{sessionId}/` 格式
- **本地存储优化**：本地数据存储键包含用户标识，避免数据混淆
- **工具函数封装**：创建 `src/utils/userCode.js` 统一管理用户标识相关功能

### 📂 文件结构变更

```
云端存储结构：
recordings/
├── A1B2/           # 用户A1B2的录音
│   ├── session1/   # 会话1的录音文件
│   └── session2/   # 会话2的录音文件
└── C3D4/           # 用户C3D4的录音
    ├── session1/   # 会话1的录音文件
    └── session3/   # 会话3的录音文件
```

### 🎨 界面更新

- **主页用户区域**：显示4字符用户标识，支持重新生成
- **音频库界面**：标题栏显示用户标识徽章
- **播放页面**：会话ID显示格式为 `{userCode}/{sessionId}`
- **会话卡片**：会话ID显示包含用户标识

### 🔒 数据安全

- **用户隔离**：每个用户只能访问自己的录音数据
- **本地存储**：用户标识存储在浏览器本地，支持数据持久化
- **云端隔离**：不同用户的文件存储在不同的云端目录

### 🔄 兼容性

- 向下兼容：现有录音文件不受影响
- 自动升级：首次打开应用时自动为用户分配标识
- 数据迁移：旧数据会逐步迁移到新的存储格式 